<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adaptive Infill Criteria â€¢ mlrMBO</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Adaptive Infill Criteria">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">mlrMBO</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../articles/mlrMBO.html">
    <span class="fa fa-bolt"></span>
     
    Quickstart
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-text-o"></span>
     
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/supplementary/mixed_space_optimization.html">Mixed Space Optimization</a>
    </li>
    <li>
      <a href="../../articles/supplementary/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/supplementary/noisy_optimization.html">Noisy Optimization</a>
    </li>
    <li>
      <a href="../../articles/supplementary/infill_criteria.html">Infill Criteria</a>
    </li>
    <li>
      <a href="../../articles/supplementary/machine_learning_with_mlrmbo.html">Machine learning with mlrMBO</a>
    </li>
    <li>
      <a href="../../articles/supplementary/human_in_the_loop_MBO.html">Human-in-the-loop MBO</a>
    </li>
    <li>
      <a href="../../articles/supplementary/mlrmbo_and_the_command_line.html">mlrMBO and the Command Line</a>
    </li>
    <li>
      <a href="../../articles/supplementary/adaptive_infill_criteria.html">Adaptive Infill Criteria</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlrMBO">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adaptive Infill Criteria</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlrMBO/blob/master/vignettes/supplementary/adaptive_infill_criteria.Rmd"><code>vignettes/supplementary/adaptive_infill_criteria.Rmd</code></a></small>
      <div class="hidden name"><code>adaptive_infill_criteria.Rmd</code></div>

    </div>

    
    
<div id="purpose" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h2>
<p>This vignette gives a short example of the usage of the adaptive infill criteria in <code>mlrMBO</code>.</p>
</div>
<div id="adaptive-infill-criteria" class="section level2">
<h2 class="hasAnchor">
<a href="#adaptive-infill-criteria" class="anchor"></a>Adaptive Infill Criteria</h2>
<p>An adaptive infill criterion can change its behaviour based on the progress of the optimization. The progress has to be supplied by the termination criterion. All integrated termination criteria support this feature.</p>
</div>
<div id="exemplary-usage-of-the-adaptive-cb" class="section level2">
<h2 class="hasAnchor">
<a href="#exemplary-usage-of-the-adaptive-cb" class="anchor"></a>Exemplary Usage of the Adaptive CB</h2>
<p>To specify which infill criterion should be used, the <code>MBOControl</code> object has to be extended by calling <code><a href="../../reference/setMBOControlInfill.html">setMBOControlInfill()</a></code>. In addition to the criterion you can also set the parameters of the infill criterion optimization. The criterion itself is created with <code>makeMBOInfillCrit*()</code>. The most common infill criteria are predefined like <code>crit.ei</code> and <code>crit.cb2</code>. See <code><a href="../../reference/MBOInfillCrit.html">?MBOInfillCrit</a></code> for details.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeMBOControl.html">makeMBOControl</a></span>()</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/setMBOControlTermination.html">setMBOControlTermination</a></span>(ctrl, <span class="dt">iters =</span> 10L)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/setMBOControlInfill.html">setMBOControlInfill</a></span>(ctrl, <span class="dt">crit =</span> <span class="kw"><a href="../../reference/infillcrits.html">makeMBOInfillCritAdaCB</a></span>(<span class="dt">cb.lambda.start =</span> <span class="dv">4</span>, <span class="dt">cb.lambda.end =</span> <span class="fl">0.1</span>))</a></code></pre></div>
<p>This will lead to an CB infill criterion (<span class="math inline">\(CB(x) = \hat{\mu}(x) \pm \lambda * \hat{s}(x)\)</span>) that will focus on uncertain regions in the beginning (<code>cb.lambda.start = 4</code>) and towards the end will have a stronger focus on areas close to the global minimum of the surrogate (<code>cb.lambda.end = 0.1</code>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">test.fun =<span class="st"> </span><span class="kw">makeSingleObjectiveFunction</span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"> <span class="dt">fn =</span> <span class="cf">function</span>(x) x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"> <span class="dt">par.set =</span> <span class="kw">makeNumericParamSet</span>(<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>, <span class="dt">len =</span> 2L)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">)</a></code></pre></div>
<p>You can now start the optimization like usual:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">res =<span class="st"> </span><span class="kw"><a href="../../reference/mbo.html">mbo</a></span>(test.fun, <span class="dt">control =</span> ctrl)</a></code></pre></div>
<p>If we look at the OptPath we can see the different progress values and the resulting different values of lambda.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">tail</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(res<span class="op">$</span>opt.path))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">##              x1           x2            y dob eol error.message exec.time</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">## 13 5.676776e-01 0.9999671865 4.550843e-02   5  NA          &lt;NA&gt;     0.000</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">## 14 4.542560e-02 0.7392614374 1.646461e-03   6  NA          &lt;NA&gt;     0.000</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">## 15 5.996035e-02 0.1325370383 1.392139e-03   7  NA          &lt;NA&gt;     0.000</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">## 16 1.795771e-05 0.5674787582 3.196892e-10   8  NA          &lt;NA&gt;     0.001</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">## 17 1.722560e-06 0.8451022455 1.690776e-12   9  NA          &lt;NA&gt;     0.000</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">## 18 3.387556e-02 0.0000185278 6.378493e-08  10  NA          &lt;NA&gt;     0.000</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">##           adacb error.model train.time    prop.type propose.time</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">## 13 -0.046950329        &lt;NA&gt;      0.074 infill_adacb        0.385</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">## 14 -0.032767558        &lt;NA&gt;      0.083 infill_adacb        0.285</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">## 15 -0.020169425        &lt;NA&gt;      0.069 infill_adacb        0.381</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">## 16 -0.012337366        &lt;NA&gt;      0.066 infill_adacb        0.340</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">## 17 -0.007385376        &lt;NA&gt;      0.104 infill_adacb        0.566</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">## 18 -0.005424012        &lt;NA&gt;      0.108 infill_adacb        0.456</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">##             se          mean lambda</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">## 13 0.077479887  0.0498995297   1.25</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">## 14 0.027061084 -0.0030003658   1.10</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">## 15 0.017583784 -0.0034648297   0.95</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">## 16 0.016909890  0.0011905455   0.80</a>
<a class="sourceLine" id="cb4-21" data-line-number="21">## 17 0.010070633 -0.0008394642   0.65</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">## 18 0.009716754 -0.0005656351   0.50</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#purpose">Purpose</a></li>
      <li><a href="#adaptive-infill-criteria">Adaptive Infill Criteria</a></li>
      <li><a href="#exemplary-usage-of-the-adaptive-cb">Exemplary Usage of the Adaptive CB</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Jakob Richter, Jakob Bossek, Daniel Horn, Michel Lang, Janek Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
