<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Quick introduction to mlrMBO &bull; mlrMBO</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mlrMBO</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mlr-org/mlrMBO">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Quick introduction to mlrMBO</h1>
            
          </div>

    
    
<div class="contents">
<p><strong>This guide gives an overview of the typical optimization workflow with mlrMBO for those familiar with model based optimization.</strong></p>
<div id="prerequisites" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#prerequisites" class="anchor"> </a></body></html>Prerequisites</h1>
<p>We demonstrate the functionality of <strong>mlrMBO</strong> by optimizing different test functions. Instead of writing these function by hand, we make use of the <a href="https://cran.r-project.org/package=smoof">smoof</a> package which offers many single objective functions frequently used for benchmarking of optimizers. <a href="https://cran.r-project.org/package=smoof">smoof</a> is a dependency and get automatically attached with mlrMBO:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mlrMBO)</code></pre></div>
<p>Note that you are not limited to these test functions bat can define arbitrary black box functions using the constructor <code>makeSingleObjectiveFunction()</code>.</p>
</div>
<div id="example-run-1d-numeric" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#example-run-1d-numeric" class="anchor"> </a></body></html>Example run: 1d numeric</h1>
<p>For our simplest example we choose a cosine mixture function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj.fun =<span class="st"> </span><span class="kw">makeCosineMixtureFunction</span>(<span class="dv">1</span>)
<span class="kw">print</span>(obj.fun)</code></pre></div>
<pre><code>## Single-objective function
## Name: Cosine Mixture Function
## Description: no description
## Tags: single-objective, discontinuous, non-differentiable, separable, scalable, multimodal
## Noisy: FALSE
## Minimize: FALSE
## Constraints: TRUE
## Number of parameters: 1
##            Type len Def  Constr Req Tunable Trafo
## x numericvector   1   - -1 to 1   -    TRUE     -
## Global optimum objective value of -0.1000 at
##   x
## 1 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggplot2::<span class="kw">autoplot</span>(obj.fun, <span class="dt">show.optimum =</span> <span class="ot">TRUE</span>) <span class="co"># FIXME: optimum is very strange?</span></code></pre></div>
<p><img src="mlrMBO_files/figure-html/cosine_fun-1.png" width="672"> We decide to use Kriging as our surrogate model and to do 10 sequential optimization steps using the Expected Improvement (EI) as the infill criterion. Furthermore, we provide an initial design on which we evaluate our first model in the beginning. We use <code>ParamHelpers::generateDesign</code> to generate 10 points via a latin hypercube.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">learner =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="st">"regr.km"</span>, <span class="dt">predict.type =</span> <span class="st">"se"</span>, <span class="dt">covtype =</span> <span class="st">"matern3_2"</span>,
  <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">trace =</span> <span class="ot">FALSE</span>))
control =<span class="st"> </span><span class="kw"><a href="../reference/makeMBOControl.html">makeMBOControl</a></span>()
control =<span class="st"> </span><span class="kw"><a href="../reference/setMBOControlTermination.html">setMBOControlTermination</a></span>(control, <span class="dt">iters =</span> <span class="dv">10</span>)
control =<span class="st"> </span><span class="kw"><a href="../reference/setMBOControlInfill.html">setMBOControlInfill</a></span>(control, <span class="dt">crit =</span> <span class="st">"ei"</span>)
design =<span class="st"> </span><span class="kw">generateDesign</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">par.set =</span> <span class="kw">getParamSet</span>(obj.fun))</code></pre></div>
<p>Finally, we start the optimization process and print the result object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">run =<span class="st"> </span><span class="kw"><a href="../reference/mbo.html">mbo</a></span>(obj.fun, <span class="dt">design =</span> design, <span class="dt">learner =</span> learner, <span class="dt">control =</span> control, <span class="dt">show.info =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Computing y column(s) for design. Not provided.</code></pre>
<pre><code>## [mbo] 0: x=0.191 : y = 0.0625 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=-0.909 : y = -0.812 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=-0.464 : y = -0.269 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=0.915 : y = -0.814 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=0.221 : y = 0.0462 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=0.78 : y = -0.703 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=-0.751 : y = -0.635 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=-0.392 : y = -0.252 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=0.466 : y = -0.268 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 0: x=-0.0091 : y = -0.0991 : 0.0 secs : initdesign</code></pre>
<pre><code>## [mbo] 1: x=0.159 : y = 0.0546 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 2: x=0.183 : y = 0.063 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 3: x=0.186 : y = 0.063 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 4: x=0.185 : y = 0.063 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 5: x=0.178 : y = 0.0625 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 6: x=0.185 : y = 0.063 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 7: x=0.184 : y = 0.063 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 8: x=0.185 : y = 0.063 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 9: x=0.188 : y = 0.0629 : 0.0 secs : infill_ei</code></pre>
<pre><code>## [mbo] 10: x=0.185 : y = 0.063 : 0.0 secs : infill_ei</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(run)</code></pre></div>
<pre><code>## Recommended parameters:
## x=0.185
## Objective: y = 0.063
## 
## Optimization path
## 10 + 10 entries in total, displaying last 10 (or less):
##            x          y dob eol error.message exec.time            ei
## 11 0.1588907 0.05461903   1  NA          &lt;NA&gt;     0.000 -4.626660e-03
## 12 0.1828983 0.06296168   2  NA          &lt;NA&gt;     0.000 -8.159317e-04
## 13 0.1859917 0.06299592   3  NA          &lt;NA&gt;     0.001 -1.450776e-04
## 14 0.1845963 0.06301121   4  NA          &lt;NA&gt;     0.000 -3.102174e-05
## 15 0.1784007 0.06247260   5  NA          &lt;NA&gt;     0.000 -8.391694e-06
## 16 0.1851540 0.06301117   6  NA          &lt;NA&gt;     0.000 -5.207821e-06
## 17 0.1840713 0.06300386   7  NA          &lt;NA&gt;     0.000 -2.018040e-06
## 18 0.1848782 0.06301220   8  NA          &lt;NA&gt;     0.000 -1.774000e-06
## 19 0.1875141 0.06292131   9  NA          &lt;NA&gt;     0.000 -1.258155e-06
## 20 0.1847485 0.06301200  10  NA          &lt;NA&gt;     0.000 -3.100181e-07
##    error.model train.time prop.type propose.time           se       mean
## 11        &lt;NA&gt;      0.039 infill_ei        0.413 1.080984e-02 0.06307507
## 12        &lt;NA&gt;      0.016 infill_ei        0.390 1.482677e-03 0.06286567
## 13        &lt;NA&gt;      0.020 infill_ei        0.318 2.499575e-04 0.06304215
## 14        &lt;NA&gt;      0.017 infill_ei        0.237 5.465563e-05 0.06301239
## 15        &lt;NA&gt;      0.098 infill_ei        0.236 3.750149e-04 0.06240517
## 16        &lt;NA&gt;      0.016 infill_ei        0.350 1.337154e-05 0.06301095
## 17        &lt;NA&gt;      0.021 infill_ei        0.321 1.224342e-05 0.06300369
## 18        &lt;NA&gt;      0.028 infill_ei        0.510 3.018281e-06 0.06301222
## 19        &lt;NA&gt;      0.029 infill_ei        0.334 5.398739e-05 0.06292588
## 20        &lt;NA&gt;      0.022 infill_ei        0.503 1.008887e-06 0.06301200</code></pre>
<p>To get better insight into the MBO process, we can start the optimization with the function <code><a href="../reference/exampleRun.html">exampleRun()</a></code> instead of <code><a href="../reference/mbo.html">mbo()</a></code>. This specialized function augments the results of <code><a href="../reference/mbo.html">mbo()</a></code> with additional information for plotting. Here, we opt to plot the optimization state at iterations 1, 3, and 10.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">run =<span class="st"> </span><span class="kw"><a href="../reference/exampleRun.html">exampleRun</a></span>(obj.fun, <span class="dt">learner =</span> learner, <span class="dt">control =</span> control, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(run)</code></pre></div>
<pre><code>## MBOExampleRun
## Number of parameters        : 1
## Parameter names             : x
## Parameter types             : numericvector
## Global Opt (known)          : -1.0000e-01
## Gap for best point          : 1.6301e-01
## True points per dim.        : 50
## Objectives                    : 1
## Points proposed per iter      : 1
## 
## Infill criterion              : ei
## Infill optimizer              : focussearch
## Infill optimizer restarts     : 1
## Final point by                : best.true.y
## Learner                     : regr.km
## Learner settings:
## jitter=FALSE,covtype=matern3_2,control=&lt;list&gt;
## Recommended parameters:
## x=0.185
## Objective: y = 6.301e-02</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotExampleRun.html">plotExampleRun</a></span>(run, <span class="dt">iters =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>), <span class="dt">pause =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<p><img src="mlrMBO_files/figure-html/cosine_plot_examplerun-1.png" width="672"><img src="mlrMBO_files/figure-html/cosine_plot_examplerun-2.png" width="672"><img src="mlrMBO_files/figure-html/cosine_plot_examplerun-3.png" width="672"></p>
</div>
<div id="example-run-2d-numeric" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#example-run-2d-numeric" class="anchor"> </a></body></html>Example run: 2d numeric</h1>
<p>We proceed with a slightly more realistic example and optimize the <a href="https://www.sfu.ca/~ssurjano/branin.html">Branin function</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj.fun =<span class="st"> </span><span class="kw">makeBraninFunction</span>()
<span class="kw">print</span>(obj.fun)</code></pre></div>
<pre><code>## Single-objective function
## Name: Branin RCOS Function
## Description: no description
## Tags: single-objective, continuous, differentiable, non-separable, non-scalable, multimodal
## Noisy: FALSE
## Minimize: TRUE
## Constraints: TRUE
## Number of parameters: 2
##            Type len Def        Constr Req Tunable Trafo
## x numericvector   2   - -5,0 to 10,15   -    TRUE     -
## Global optimum objective value of 0.3979 at
##          x1     x2
## 1 -3.141593 12.275
## 2  3.141593  2.275
## 3  9.424778  2.475</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggplot2::<span class="kw">autoplot</span>(obj.fun, <span class="dt">render.levels =</span> <span class="ot">TRUE</span>, <span class="dt">show.optimum =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: Ignoring unknown aesthetics: fill</code></pre>
<p><img src="mlrMBO_files/figure-html/branin_fun-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#prerequisites">Prerequisites</a></li>
      <li><a href="#example-run-1d-numeric">Example run: 1d numeric</a></li>
      <li><a href="#example-run-2d-numeric">Example run: 2d numeric</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Jakob Bossek, Jakob Richter, Daniel Horn, Michel Lang, Janek Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
